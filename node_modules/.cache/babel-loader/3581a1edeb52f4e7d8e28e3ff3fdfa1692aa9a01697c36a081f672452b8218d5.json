{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{useLocation}from'react-router-dom';import{userRequest}from'../requestMethod';import{resetCustomerCart}from'../redux/apiCalls';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Success=()=>{const location=useLocation();const cart=location.state.cart;const stripeData=location.state.stripeData;const[orderId,setOrderId]=useState(null);const currentCustomer=useSelector(state=>state.customer.currentCustomer);const dispatch=useDispatch();useEffect(()=>{const createOrder=async()=>{try{const res=await userRequest.post(\"/orders\",{userId:currentCustomer._id,products:cart.products.map(item=>({productId:item._id,title:item.title,img:item.img,size:item.size,color:item.color,quantity:item._quantity})),amount:stripeData.amount,address:stripeData.billing_details.address,payment:'online',paymentStatus:'done'});console.log(res.data);setOrderId(res.data._id);resetCustomerCart(dispatch);}catch{}};stripeData&&createOrder();},[cart,stripeData,currentCustomer,dispatch]);return/*#__PURE__*/_jsxs(\"div\",{style:{height:\"100vh\",display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\"},children:[orderId?\"Order has been created successfully. Your order number is \".concat(orderId):\"Successfull. Your order is being prepared...\",/*#__PURE__*/_jsx(\"button\",{onClick:()=>{window.location.href='/';},style:{padding:10,marginTop:20},children:\"Continue Shopping\"})]});};export default Success;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","useLocation","userRequest","resetCustomerCart","jsx","_jsx","jsxs","_jsxs","Success","location","cart","state","stripeData","orderId","setOrderId","currentCustomer","customer","dispatch","createOrder","res","post","userId","_id","products","map","item","productId","title","img","size","color","quantity","_quantity","amount","address","billing_details","payment","paymentStatus","console","log","data","style","height","display","flexDirection","alignItems","justifyContent","children","concat","onClick","window","href","padding","marginTop"],"sources":["C:/Users/Abdu/OneDrive/Desktop/React/my-ecommerce/src/pages/Success.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useLocation } from 'react-router-dom'\r\nimport { userRequest } from '../requestMethod';\r\nimport { resetCustomerCart } from '../redux/apiCalls';\r\nconst Success = () => {\r\n  const location = useLocation();\r\n  const cart = location.state.cart;\r\n  const stripeData = location.state.stripeData;\r\n  const [orderId, setOrderId] = useState(null);\r\n  const currentCustomer = useSelector((state) => state.customer.currentCustomer);\r\n  const dispatch = useDispatch();\r\n  \r\n  useEffect(() => {\r\n    const createOrder = async () => {\r\n      try {\r\n        const res = await userRequest.post(\"/orders\", {\r\n          userId: currentCustomer._id,\r\n          products: cart.products.map((item) => ({\r\n            productId: item._id,\r\n            title: item.title,\r\n            img: item.img,\r\n            size: item.size,\r\n            color: item.color,\r\n            quantity: item._quantity,\r\n          })),\r\n          amount: stripeData.amount,\r\n          address: stripeData.billing_details.address,\r\n          payment: 'online',\r\n          paymentStatus: 'done'\r\n        });\r\n        console.log(res.data);\r\n        setOrderId(res.data._id);\r\n        resetCustomerCart(dispatch);\r\n      } catch {}\r\n    };\r\n    stripeData && createOrder();\r\n  }, [cart, stripeData, currentCustomer,dispatch]);\r\n  return (\r\n    <div\r\n      style={{\r\n        height: \"100vh\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n      }}\r\n    >\r\n      {orderId\r\n        ? `Order has been created successfully. Your order number is ${orderId}`\r\n        : `Successfull. Your order is being prepared...`}\r\n      <button onClick={()=>{window.location.href = '/'}} style={{ padding: 10, marginTop: 20 }}>Continue Shopping</button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Success\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,iBAAiB,KAAQ,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACtD,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACpB,KAAM,CAAAC,QAAQ,CAAGR,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAS,IAAI,CAAGD,QAAQ,CAACE,KAAK,CAACD,IAAI,CAChC,KAAM,CAAAE,UAAU,CAAGH,QAAQ,CAACE,KAAK,CAACC,UAAU,CAC5C,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAAiB,eAAe,CAAGf,WAAW,CAAEW,KAAK,EAAKA,KAAK,CAACK,QAAQ,CAACD,eAAe,CAAC,CAC9E,KAAM,CAAAE,QAAQ,CAAGlB,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAqB,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAjB,WAAW,CAACkB,IAAI,CAAC,SAAS,CAAE,CAC5CC,MAAM,CAAEN,eAAe,CAACO,GAAG,CAC3BC,QAAQ,CAAEb,IAAI,CAACa,QAAQ,CAACC,GAAG,CAAEC,IAAI,GAAM,CACrCC,SAAS,CAAED,IAAI,CAACH,GAAG,CACnBK,KAAK,CAAEF,IAAI,CAACE,KAAK,CACjBC,GAAG,CAAEH,IAAI,CAACG,GAAG,CACbC,IAAI,CAAEJ,IAAI,CAACI,IAAI,CACfC,KAAK,CAAEL,IAAI,CAACK,KAAK,CACjBC,QAAQ,CAAEN,IAAI,CAACO,SACjB,CAAC,CAAC,CAAC,CACHC,MAAM,CAAErB,UAAU,CAACqB,MAAM,CACzBC,OAAO,CAAEtB,UAAU,CAACuB,eAAe,CAACD,OAAO,CAC3CE,OAAO,CAAE,QAAQ,CACjBC,aAAa,CAAE,MACjB,CAAC,CAAC,CACFC,OAAO,CAACC,GAAG,CAACpB,GAAG,CAACqB,IAAI,CAAC,CACrB1B,UAAU,CAACK,GAAG,CAACqB,IAAI,CAAClB,GAAG,CAAC,CACxBnB,iBAAiB,CAACc,QAAQ,CAAC,CAC7B,CAAE,KAAM,CAAC,CACX,CAAC,CACDL,UAAU,EAAIM,WAAW,CAAC,CAAC,CAC7B,CAAC,CAAE,CAACR,IAAI,CAAEE,UAAU,CAAEG,eAAe,CAACE,QAAQ,CAAC,CAAC,CAChD,mBACEV,KAAA,QACEkC,KAAK,CAAE,CACLC,MAAM,CAAE,OAAO,CACfC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CAAAC,QAAA,EAEDlC,OAAO,8DAAAmC,MAAA,CACyDnC,OAAO,gDACtB,cAClDR,IAAA,WAAQ4C,OAAO,CAAEA,CAAA,GAAI,CAACC,MAAM,CAACzC,QAAQ,CAAC0C,IAAI,CAAG,GAAG,EAAE,CAACV,KAAK,CAAE,CAAEW,OAAO,CAAE,EAAE,CAAEC,SAAS,CAAE,EAAG,CAAE,CAAAN,QAAA,CAAC,mBAAiB,CAAQ,CAAC,EACjH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAvC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}